/* public/css/wiki.css */

/*
========================================
    WIKI STYLES
========================================
Styles for the standalone Wiki pages (Main and Article pages)
Using variables from style.css
========================================
*/

/* Import global theme variables and base styles */
@import url('style.css');

/* ------------------------------------ */
/*  BASE & LAYOUT                       */
/* ------------------------------------ */

body.wiki-page-body {
    /* Prevent body padding from affecting fixed elements */
    padding-top: 0 !important;
    /* Ensure content is below the potentially sticky top bar even without JS */
    padding-bottom: var(--spacing-lg); /* Add some padding at the very bottom */
    min-height: 100vh; /* Ensure body takes at least full viewport height */
}

.wiki-layout-container {
    display: flex;
    gap: var(--spacing-lg); /* Space between sidebar and content */
    padding: var(--spacing-md); /* Base page padding (adjusted to sit below sticky topbar) */
    margin-top: 0; /* Remove default margin */
    align-items: flex-start; /* Align sidebar and content to the top */
    max-width: 1400px; /* Limit max width for the main layout */
    margin: 0 auto; /* Center the main layout */
    width: 100%; /* Container takes full width within its parent */
    box-sizing: border-box; /* Include padding in width */
    /* Use padding-top on the main layout container based on sticky header height if needed */
    /* E.g. padding-top: calc(var(--wiki-top-bar-height, 60px) + var(--spacing-md)); */
}


/* ------------------------------------ */
/*  WIKI TOP BAR                        */
/* ------------------------------------ */

.wiki-top-bar {
    background-color: var(--bg-panel);
    padding: var(--spacing-xs) 0;
    border-bottom: 1px solid var(--border-medium);
    box-shadow: var(--shadow-minimal);
    position: sticky;
    top: 0;
    z-index: 900; /* Below main site header (1000), but above page content */
    width: 100%;
    left: 0;
    /* Define variable for calculation if needed */
     --wiki-top-bar-height: 60px; /* Approximate height, adjust based on actual rendered height */
}

.wiki-top-bar-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--spacing-md);
    /* Uses .container max-width */
}

.wiki-top-bar-logo img {
    height: 45px; /* Adjust logo size in top bar */
    display: block;
}

.wiki-top-bar-nav ul {
    display: flex;
    gap: var(--spacing-md);
    list-style: none;
    padding: 0;
    margin: 0;
}

/* Specific style overrides for btn-secondary in top bar */
.wiki-top-bar-nav .btn.btn-secondary.btn-small {
    padding: var(--spacing-xs) var(--spacing-sm);
    font-size: 0.9em;
    box-shadow: var(--shadow-minimal);
    transform: none; /* Remove default hover transform */
    border-color: var(--border-medium);
    background-color: var(--btn-secondary-bg);
    color: var(--btn-secondary-text);
}

.wiki-top-bar-nav .btn.btn-secondary.btn-small:hover {
    background-color: var(--btn-secondary-hover-bg);
    color: var(--text-primary);
    box-shadow: var(--shadow-subtle);
}

.wiki-top-bar-nav .btn.btn-secondary.btn-small:active {
    transform: none;
    box-shadow: var(--shadow-inset);
}


/* ------------------------------------ */
/*  SIDEBAR NAVIGATION                  */
/* ------------------------------------ */

.wiki-sidebar {
    flex: 0 0 250px; /* Fixed width */
    background: var(--bg-panel);
    border: 1px solid var(--border-medium);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-panel);
    padding: var(--spacing-md);
    /* Calculated height to fit below sticky top bar with padding */
    max-height: calc(100vh - var(--wiki-top-bar-height, 60px) - var(--spacing-md) - var(--spacing-md));
    position: sticky;
    top: calc(var(--wiki-top-bar-height, 60px) + var(--spacing-md)); /* Position below sticky top bar + padding */
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.15) rgba(255, 255, 255, 0.05);
}

.wiki-sidebar::-webkit-scrollbar {
    width: 8px;
}

.wiki-sidebar::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: var(--radius-md);
}

.wiki-sidebar::-webkit-scrollbar-thumb {
    background-color: rgba(255, 255, 255, 0.15);
    border-radius: var(--radius-md);
    border: 2px solid var(--bg-panel);
}

.wiki-sidebar::-webkit-scrollbar-thumb:hover {
    background-color: rgba(255, 255, 255, 0.25);
}


/* Sidebar Search Input */
.wiki-sidebar-search {
    position: relative;
    margin-bottom: var(--spacing-md);
    padding-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--border-soft);
}

.wiki-sidebar-search .wiki-search-input {
    width: 100%;
    padding: var(--spacing-xs) var(--spacing-sm);
    padding-right: var(--spacing-md); /* Space for icon */
    background-color: var(--bg-panel-subtle);
    border: 1px solid var(--border-medium);
    border-radius: var(--radius-sm);
    color: var(--text-primary);
    font-size: 0.95em;
}

.wiki-sidebar-search .wiki-search-input::placeholder {
    color: var(--text-secondary);
    opacity: 0.7;
}

.wiki-sidebar-search .wiki-search-input:focus {
    outline: none;
    border-color: var(--accent-color-light);
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.15), 0 0 0 1px color-mix(in srgb, var(--accent-color-light) 30%, transparent);
}

.wiki-sidebar-search .fas {
    position: absolute;
    top: 50%;
    right: var(--spacing-xs);
    transform: translateY(-50%);
    color: var(--text-secondary);
    font-size: 0.9em;
}


/* Sidebar Nav List */
.wiki-nav-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.wiki-nav-list li {
    margin-bottom: 0px; /* Control vertical space using line-height and bottom margin only where headings apply */
    line-height: 1.6;
}

.wiki-nav-list li a {
    color: var(--accent-color-light); /* Standard link color */
    text-decoration: none;
    font-size: 1em;
    padding: 2px 0;
    display: block; /* Make link clickable over the line */
    transition: color var(--transition-fast);
}

.wiki-nav-list li a:hover {
    color: var(--text-primary); /* Hover color */
    text-decoration: underline;
}

.wiki-nav-list .nav-item-active a {
    color: var(--text-primary); /* Active link color */
    font-weight: 600;
    /* Consider text-decoration: underline; or a different indicator if preferred */
}


/* Sidebar Nav Headings */
.wiki-nav-list .nav-heading {
    font-family: 'Poppins', sans-serif;
    font-size: 0.95em;
    color: var(--text-primary);
    font-weight: 600;
    text-transform: uppercase;
    margin-top: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
    padding: 0;
    border-bottom: 1px dashed var(--border-soft);
    padding-bottom: var(--spacing-xs);
    cursor: default;
     line-height: 1.2; /* Tighter line-height for headings */
}

/* Space after lists ending before a heading */
.wiki-nav-list li:not(.nav-heading) + .nav-heading {
     margin-top: var(--spacing-lg); /* Add more space before a heading if it follows a list item */
}


/* ------------------------------------ */
/*  WIKI CONTENT AREA                   */
/* ------------------------------------ */

.wiki-content {
    flex: 1; /* Takes remaining space */
    padding: var(--spacing-sm) 0; /* Vertical padding around content blocks */
}


/* Content Header (for Page Title and Flags) */
.wiki-content-header {
    display: flex;
    /* Default flex direction will be row */
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--border-medium);
    padding-bottom: var(--spacing-md);
    align-items: flex-start; /* Default alignment */
}

/* Styles for the main wiki page header */
.wiki-content-header.main-page-header {
    flex-direction: column; /* Stack title and flags on main page */
    align-items: center; /* Center content */
    border-bottom: none; /* No border below main title */
    margin-bottom: var(--spacing-xl); /* More space after main title */
    padding-bottom: 0;
}


/* Page Title */
.wiki-page-title {
    font-family: 'Poppins', sans-serif;
    font-size: 2.2em; /* Standard article page title size */
    color: var(--accent-color-light); /* Accent color for article titles */
    margin: 0; /* Managed by parent flex/gap */
    font-weight: 700;
    text-shadow: var(--shadow-minimal);
}

/* Main Wiki Page Title */
.wiki-page-title.wiki-main-page-title {
    font-size: 2.6em; /* Larger size */
    color: var(--hero-title); /* White color */
    text-shadow: var(--shadow-subtle);
    text-align: center;
}


/* Language Flags */
.wiki-language-flags {
    display: flex;
    gap: var(--spacing-xs);
}

.wiki-language-flags a { /* Apply link styles */
    display: flex; /* Keep img/icon aligned */
     text-decoration: none; /* No underline */
}

.wiki-language-flags a img {
    height: 20px; /* Flag icon size */
    width: auto;
    border-radius: var(--radius-sm);
    box-shadow: var(--shadow-minimal);
    transition: transform var(--transition-fast), box-shadow var(--transition-fast), border-color var(--transition-fast);
    border: 1px solid transparent;
    object-fit: cover; /* Ensure image fills space without stretching */
}

.wiki-language-flags a img:hover {
    transform: scale(1.1);
    box-shadow: var(--shadow-subtle);
}

.wiki-language-flags .wiki-flag-active img {
    border-color: var(--accent-color-light);
    box-shadow: var(--shadow-subtle);
    transform: scale(1.05); /* Slightly highlight active flag */
}

/* Intro Paragraph */
.wiki-intro {
    font-size: 1.1em;
    line-height: 1.7;
    color: var(--text-primary);
    margin: var(--spacing-sm) 0 var(--spacing-lg) 0;
    padding: var(--spacing-sm) var(--spacing-md);
    background-color: var(--bg-panel-subtle);
    border-left: 4px solid var(--accent-color-light); /* Accent border */
    border-radius: var(--radius-sm);
}


/* ------------------------------------ */
/*  CONTENT PANELS (Common Style)       */
/* ------------------------------------ */

.wiki-panel {
    background-color: var(--bg-panel);
    border: 1px solid var(--border-medium);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-minimal);
    padding: var(--spacing-md); /* Internal padding for all panels */
    margin-bottom: var(--spacing-lg); /* Space between panels */
    transition: box-shadow var(--transition-fast), border-color var(--transition-fast);
}

.wiki-panel:hover {
    box-shadow: var(--shadow-subtle);
    /* Optional hover border color */
    /* border-color: var(--accent-color); */
}

.wiki-content > .wiki-panel:last-child {
    margin-bottom: 0; /* Remove bottom margin for the last panel in content area */
}


/* ------------------------------------ */
/*  TABLE OF CONTENTS (WIKI-TOC)        */
/* ------------------------------------ */
/* Specific style overrides for TOC panel */
.wiki-toc.wiki-panel { /* Combined class for specificity */
    background-color: var(--bg-panel-subtle);
    border-color: var(--border-soft);
    padding: var(--spacing-md); /* Use standard panel padding */
    margin-bottom: var(--spacing-lg); /* Space below TOC */
}


.wiki-toc-title {
    background: linear-gradient(to right, var(--color-purple-neon), color-mix(in srgb, var(--color-purple-neon) 80%, black)); /* Matching image purple gradient */
    color: var(--text-primary);
    font-family: 'Poppins', sans-serif;
    font-size: 1.3em; /* Slightly larger title for TOC bar */
    font-weight: 700;
    padding: var(--spacing-sm) var(--spacing-md); /* Padding inside title bar */
     margin: calc(var(--spacing-md) * -1) calc(var(--spacing-md) * -1) var(--spacing-sm) calc(var(--spacing-md) * -1); /* Negative margins to span full width over parent padding */
    border-top-left-radius: var(--radius-md);
    border-top-right-radius: var(--radius-md);
    display: flex;
    justify-content: space-between;
    align-items: center;
}
/* Remove the separator, as the title bar is now a distinct element */
/* .wiki-toc-title { border-bottom: none; padding-bottom: 0; margin-bottom: var(--spacing-sm);} */


.wiki-toc-title .toc-toggle {
    font-size: 0.9em;
    font-weight: 500;
    color: var(--text-primary); /* Toggle color matching bar text */
    cursor: pointer;
    user-select: none;
    transition: color var(--transition-fast), text-decoration var(--transition-fast);
}

.wiki-toc-title .toc-toggle:hover {
     color: color-mix(in srgb, var(--text-primary) 80%, white); /* Lighter hover color */
    text-decoration: underline;
}


.wiki-toc-list {
    list-style: none;
    padding: 0;
    margin: 0; /* Reset margin, vertical spacing from list items */
    transition: max-height 0.4s ease-in-out, opacity 0.4s ease-in-out;
    overflow: hidden;
    max-height: 1000px;
    opacity: 1;
}

.wiki-toc.hidden .wiki-toc-list {
    max-height: 0;
    opacity: 0;
}

.wiki-toc-list li {
    margin-bottom: 4px;
    line-height: 1.5;
}

.wiki-toc-list li:last-child {
    margin-bottom: 0;
}

.wiki-toc-list li a {
    color: var(--text-secondary); /* Less prominent color for TOC links */
    text-decoration: none;
    font-size: 0.95em;
    padding: 0;
    display: inline-block;
    transition: color var(--transition-fast);
}

.wiki-toc-list li a:hover {
    color: var(--text-primary);
    text-decoration: underline;
}

/* Indentation for nested lists */
.wiki-toc-list ul {
    list-style: none;
    padding-left: var(--spacing-md);
    margin-top: 0px; /* Tighter nesting */
    margin-bottom: 0px;
}

.wiki-toc-list ul li a {
    font-size: 0.9em;
}


/* ------------------------------------ */
/*  MAIN IMAGE                          */
/* ------------------------------------ */

.wiki-main-image {
    text-align: center;
    margin: var(--spacing-md) 0 var(--spacing-lg) 0;
}

.wiki-main-image img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-panel);
    border: 1px solid var(--border-medium);
}


/* ------------------------------------ */
/*  ARTICLE CONTENT SECTIONS            */
/* ------------------------------------ */
/* Standard section blocks use wiki-panel styling */
.wiki-section {
    /* Uses wiki-panel styling */
    padding: var(--spacing-md); /* Consistent internal padding */
}

.wiki-section-title {
    font-family: 'Poppins', sans-serif;
    font-size: 1.4em;
    color: var(--text-primary);
    font-weight: 700;
    margin: 0 0 var(--spacing-md) 0;
    padding-bottom: var(--spacing-xs);
    border-bottom: 2px solid var(--accent-color);
    display: block; /* Underline spans full width */
}

.wiki-subsection {
    margin-top: var(--spacing-md);
    padding-top: var(--spacing-sm);
    border-top: 1px dashed var(--border-soft);
}

.wiki-subsection-title {
    font-family: 'Poppins', sans-serif;
    font-size: 1.1em;
    color: var(--accent-color-light);
    font-weight: 600;
    margin: 0 0 var(--spacing-sm) 0;
}


/* Paragraph and list styles */
.wiki-content p,
.wiki-section p {
    font-size: 1em;
    line-height: 1.7;
    color: var(--text-secondary);
    margin: 0 0 var(--spacing-md) 0;
}

.wiki-content p:last-child,
.wiki-section p:last-child {
    margin-bottom: 0;
}

.wiki-content ul,
.wiki-section ul {
    list-style: none;
    padding: 0;
    margin: var(--spacing-md) 0;
}

.wiki-content ul li,
.wiki-section ul li {
    position: relative;
    padding-left: var(--spacing-md);
    margin-bottom: var(--spacing-xs);
    color: var(--text-secondary);
    font-size: 1em;
    line-height: 1.6;
}

.wiki-content ul li:last-child,
.wiki-section ul li:last-child {
    margin-bottom: 0;
}

/* Custom bullet using ::before */
.wiki-content ul li::before,
.wiki-section ul li::before {
    content: '\2022'; /* Unicode bullet point */
    position: absolute;
    left: 0;
    top: 0;
    color: var(--accent-color-light);
    font-weight: bold;
}

/* Style for list items meant to use the Font Awesome icon INSTEAD of the bullet */
.wiki-section ul li i.fas.wiki-list-icon {
    /* Icon as bullet style */
    display: inline-block;
    margin-right: var(--spacing-xs);
    font-size: 1em;
    position: static;
    transform: none; /* Reset positioning */
    vertical-align: top; /* Align icon with text top */
    color: var(--accent-color-light);
}

/* More robust list styling with explicit class */
.wiki-section ul li.icon-bullet { /* Add this class in EJS for items using icon as bullet */
     list-style: none;
     padding-left: 0;
     display: flex; /* Use flex for alignment */
     align-items: flex-start; /* Align items to top */
     gap: var(--spacing-xs); /* Space between icon and text */
}
.wiki-section ul li.icon-bullet::before { content: none; /* Remove default bullet */ }
.wiki-section ul li.icon-bullet .list-text { flex: 1; } /* Text fills space */
.wiki-section ul li.icon-bullet i.fas { flex-shrink: 0; font-size: 1.1em; /* Larger icon */ }


/* Links within content */
.wiki-section p a,
.wiki-section ul li a,
.wiki-content p a,
.wiki-content ul li a {
    color: var(--accent-color-light);
    text-decoration: underline; /* Underline internal links by default */
    transition: color var(--transition-fast), text-decoration var(--transition-fast);
}

.wiki-section p a:hover,
.wiki-section ul li a:hover,
.wiki-content p a:hover,
.wiki-content ul li a:hover {
    color: var(--accent-color);
    text-decoration: none; /* Remove underline on hover */
}

.category-links a { /* Override general content link style for main index */
     text-decoration: none; /* No underline for index links by default */
}
.category-links a:hover {
     text-decoration: underline; /* Add underline on hover */
}

/* Highlighted Text Colors */
.wiki-highlight-text-tier { color: var(--accent-color-light); font-weight: 600; }
.wiki-highlight-text-tier-1 { color: #a0522d; font-weight: 600; }
.wiki-highlight-text-tier-7 { color: #ff0000; font-weight: 600; }
.wiki-highlight-text-xy { color: var(--color-yellow-vibrant); font-weight: 600; }


/* ------------------------------------ */
/*  MAIN WIKI INDEX (Main Page Specific) */
/* ------------------------------------ */

.main-wiki-index.wiki-panel {
    /* Uses wiki-panel style, but padding adjusted below */
    padding: 0; /* Remove internal padding so title bar spans edge-to-edge */
}

.main-index-title-bar {
    background: linear-gradient(to right, var(--color-purple-neon), color-mix(in srgb, var(--color-purple-neon) 80%, black));
    color: var(--text-primary);
    font-family: 'Poppins', sans-serif;
    font-size: 1.4em; /* Slightly larger title bar font */
    font-weight: 700;
    padding: var(--spacing-sm) var(--spacing-md);
    border-top-left-radius: var(--radius-md);
    border-top-right-radius: var(--radius-md);
    margin-bottom: var(--spacing-md); /* More space below title bar */
}

.main-wiki-index .index-categories {
    padding: 0 var(--spacing-md) var(--spacing-md) var(--spacing-md); /* Padding applies to the container holding categories */
}

.index-category {
    display: flex;
    align-items: flex-start; /* Align items to the top */
    gap: var(--spacing-sm); /* Space between icon/title block and links */
    margin-bottom: var(--spacing-sm);
    padding-bottom: var(--spacing-sm); /* Space above separator */
}

.index-category:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
}

.index-category .category-icon {
    width: 35px; /* Icon container size */
    height: 35px;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-shrink: 0;
     filter: drop-shadow(var(--shadow-minimal)); /* Add slight shadow to icons */
}
.index-category .category-icon img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    filter: saturate(1.3) brightness(1.1); /* Boost color/brightness */
     transition: transform var(--transition-fast);
}
.index-category:hover .category-icon img {
     transform: scale(1.1);
}

.index-category .category-info { /* New wrapper for title and links */
     flex-grow: 1;
     display: flex;
     flex-direction: column; /* Stack title and links */
     align-items: flex-start; /* Align title and links to left */
}

.index-category .category-title {
    font-family: 'Poppins', sans-serif;
    font-size: 1.05em; /* Category title font size */
    color: var(--text-primary);
    font-weight: 600;
    margin: 0 0 var(--spacing-xs) 0;
    line-height: 1.2;
    /* Removed flex-shrink, flex-basis etc as it's inside category-info flex column */
}

.index-category .category-links {
    font-size: 0.95em; /* Links font size */
    color: var(--text-secondary);
    line-height: 1.7;
    /* flex-grow: 1 removed, managed by category-info flex grow */
    /* margin-top: removed, gap controlled by flex column */
    word-break: break-word;
    hyphens: auto;
    width: 100%; /* Ensure links block takes available width */
}
.index-category .category-links a {
     color: var(--accent-color-light);
     text-decoration: none;
     white-space: nowrap;
      margin-right: 5px; /* Space after link */
      margin-left: 5px; /* Space before link */
}
.index-category .category-links a:first-child { margin-left: 0; }
.index-category .category-links a:last-child { margin-right: 0; }


.category-links .external-link-icon {
    font-size: 0.75em; /* Smaller icon */
    vertical-align: middle; /* Align with middle of text */
    color: var(--text-secondary);
     margin-left: 2px; /* Space between link text and icon */
}


.category-separator {
    height: 1px;
    background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQYV2NMzswswsLCoAYxMTAwFkDMwKAATQEAdpwCLsL0AegAAAAASUVORK5CYII=') repeat-x center;
    background-size: 3px 1px;
    opacity: 0.2; /* More subtle dot */
    width: 100%;
    margin-top: var(--spacing-sm); /* Space above separator */
    /* Removed clear:both */
}


/* ------------------------------------ */
/*  FEATURED ARTICLES                   */
/* ------------------------------------ */

.featured-articles-section.wiki-panel {
    /* Uses wiki-panel style */
}

.featured-articles-section .wiki-section-title {
    /* Reuses wiki-section-title styling */
    margin-bottom: var(--spacing-lg);
}

.featured-articles-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: var(--spacing-lg);
}

.featured-article-card.wiki-panel {
    /* Uses wiki-panel style */
    padding: var(--spacing-sm);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    border: 1px solid var(--border-soft);
    transition: transform var(--transition-fast), box-shadow var(--transition-fast), border-color var(--transition-fast);
}

.featured-article-card.wiki-panel:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-subtle), 0 0 0 1px var(--accent-color-light);
    border-color: var(--accent-color-light);
}


.featured-article-card img {
    width: 100%;
    height: 180px;
    object-fit: cover;
    border-radius: var(--radius-sm);
    margin-bottom: var(--spacing-sm);
    box-shadow: var(--shadow-minimal);
}

.featured-article-card .article-content {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
}

.featured-article-card h4 {
    font-family: 'Poppins', sans-serif;
    font-size: 1.1em;
    color: var(--text-primary);
    font-weight: 700;
    margin: 0 0 var(--spacing-xs) 0;
    line-height: 1.4;
}

.featured-article-card p {
    font-size: 0.9em;
    color: var(--text-secondary);
    margin: 0 0 var(--spacing-sm) 0;
    line-height: 1.5;
    flex-grow: 1;
}

.featured-article-card .btn-tertiary {
    align-self: flex-start;
    font-size: 0.85em;
    margin-top: auto; /* Pushes the button to the bottom */
}


/* ------------------------------------ */
/*  MEDIA QUERIES                       */
/* ------------------------------------ */

/* 1000px: Stack sidebar and content */
@media(max-width:1000px) {
    .wiki-top-bar {
        position: static;
    }

    body.wiki-page-body {
        padding-top: 0 !important;
    }

    .wiki-layout-container {
        flex-direction: column;
        gap: var(--spacing-md);
        padding: var(--spacing-xl) var(--spacing-md);
    }

    .wiki-sidebar {
        flex: auto;
        width: 100%;
        max-height: none;
        position: static;
        top: auto;
        overflow-y: visible;
        padding: var(--spacing-md);
        box-shadow: var(--shadow-minimal); /* Less shadow when not sticky */
    }

    .wiki-sidebar-search {
        margin-bottom: var(--spacing-md);
        padding-bottom: var(--spacing-md);
    }

    .wiki-nav-list {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-sm) var(--spacing-md);
        justify-content: center;
    }

    .wiki-nav-list li {
        line-height: 1.5;
    }

    .wiki-nav-list .nav-heading {
        width: 100%;
        text-align: center;
        margin-top: var(--spacing-md);
        margin-bottom: var(--spacing-sm);
    }

    .wiki-nav-list li a {
        display: inline-block;
    }

    .wiki-content {
        flex: auto;
        padding: var(--spacing-md) 0;
    }

    .wiki-page-title {
        font-size: 2.2em;
    }

    .wiki-main-page-title {
        font-size: 2.4em;
    }

    .wiki-intro {
        font-size: 1em;
        padding: var(--spacing-sm);
        margin: var(--spacing-md) 0; /* Adjust vertical margin */
    }

    .wiki-panel {
        margin-bottom: var(--spacing-md);
    }

    .wiki-toc-title {
        font-size: 1.2em;
    }

    .wiki-toc-title {
        margin: calc(var(--spacing-md) * -1) calc(var(--spacing-md) * -1) var(--spacing-sm) calc(var(--spacing-md) * -1);
        padding: var(--spacing-sm);
    }

    .wiki-toc-list li a,
    .wiki-toc-list ul li a {
        font-size: 0.9em;
    }


    .main-index-title-bar {
        font-size: 1.2em;
        padding: var(--spacing-sm);
         margin-bottom: var(--spacing-md);
    }

     .main-wiki-index .index-categories {
          padding: 0 var(--spacing-md) var(--spacing-md) var(--spacing-md); /* Adjust padding */
     }

     .index-category {
         align-items: center; /* Center icon and title vertically on smaller screens */
         gap: var(--spacing-md); /* Increase gap between elements */
          margin-bottom: var(--spacing-md);
          padding-bottom: var(--spacing-md);
     }

     .index-category .category-icon { width: 30px; height: 30px; } /* Smaller icons */
      .index-category .category-info {
           flex-direction: row; /* Put title and links side-by-side */
           flex-wrap: wrap; /* Allow links to wrap */
           gap: var(--spacing-xs) var(--spacing-md); /* Gap between title and links block */
            margin-top: 0; /* Reset margin */
       }
     .index-category .category-title {
           font-size: 1.1em; /* Revert size */
            margin: 0; /* Reset margin */
             flex-basis: 100%; /* Title takes full width first */
              text-align: center;
     }
     .index-category .category-links {
           font-size: 0.95em;
            flex-basis: 100%; /* Links take full width below title */
            text-align: center; /* Center links */
             line-height: 1.6;
             margin-top: var(--spacing-xs); /* Space below title */
      }
       .index-category .category-links a { white-space: normal; } /* Allow links to wrap naturally */
        .index-category .category-links a,
         .index-category .category-links a:first-child,
          .index-category .category-links a:last-child {
               margin: 0px var(--spacing-xs); /* Consistent small margin around links */
         }

     .category-separator { margin-top: var(--spacing-md); } /* Adjust separator spacing */


    .featured-articles-grid {
        gap: var(--spacing-md);
    }

    .featured-article-card img {
        height: 160px;
    }

    .featured-article-card h4 {
        font-size: 1em;
    }

    .featured-article-card p {
        font-size: 0.85em;
    }
}


@media(max-width:768px) {
    .wiki-top-bar-logo img {
        height: 35px;
    }

    .wiki-top-bar-nav .btn {
        font-size: 0.85em;
        padding: var(--spacing-xs) var(--spacing-sm);
    }

    .wiki-layout-container {
        padding: var(--spacing-lg) var(--spacing-md);
        gap: var(--spacing-md);
    }

    .wiki-sidebar {
        padding: var(--spacing-md);
    }

    .wiki-sidebar-search {
        margin-bottom: var(--spacing-md);
        padding-bottom: var(--spacing-md);
    }

    .wiki-nav-list {
        gap: var(--spacing-xs) var(--spacing-md);
    }

    .wiki-nav-list li a {
        font-size: 0.9em;
    }

    .wiki-nav-list .nav-heading {
        font-size: 0.8em;
    }

    .wiki-content {
        padding: var(--spacing-md) 0;
    }

    .wiki-content-header {
        gap: var(--spacing-sm);
        padding-bottom: var(--spacing-sm);
        margin-bottom: var(--spacing-md);
    }

    .wiki-page-title {
        font-size: 1.8em;
    }

    .wiki-main-page-title {
        font-size: 2em;
    }

    .wiki-language-flags img {
        height: 18px;
    }

    .wiki-intro {
        font-size: 0.95em;
        padding: var(--spacing-sm) var(--spacing-md);
        margin: var(--spacing-sm) 0 var(--spacing-md) 0;
    }

    .wiki-panel {
        padding: var(--spacing-md);
        margin-bottom: var(--spacing-md);
    }

    .wiki-toc-title {
        font-size: 1em;
    }

     .wiki-toc-title {
         margin: calc(var(--spacing-md) * -1) calc(var(--spacing-md) * -1) var(--spacing-sm) calc(var(--spacing-md) * -1);
         padding: var(--spacing-sm);
     }


    .wiki-toc-list li a,
    .wiki-toc-list ul li a {
        font-size: 0.85em;
    }

    .wiki-toc-list ul {
        padding-left: var(--spacing-md);
    }

    .main-index-title-bar {
        font-size: 1.1em;
        padding: var(--spacing-sm);
    }

    .index-category .category-icon {
        width: 28px; /* Adjust icon size */
        height: 28px;
    }

     .index-category .category-info { gap: var(--spacing-xs); }
      .index-category .category-title { font-size: 1em; margin: 0 0 var(--spacing-xs) 0; }
      .index-category .category-links { font-size: 0.9em; line-height: 1.5; }

    .wiki-section-title {
        font-size: 1.2em;
    }

    .wiki-subsection-title {
        font-size: 1em;
    }

    .wiki-content p,
    .wiki-section p,
    .wiki-content ul li,
    .wiki-section ul li {
        font-size: 0.95em;
        line-height: 1.6;
    }

    .wiki-section ul li,
    .wiki-content ul li {
        padding-left: var(--spacing-md);
    }


    .featured-articles-grid {
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: var(--spacing-md);
    }

    .featured-article-card img {
        height: 140px;
        margin-bottom: var(--spacing-sm);
    }

    .featured-article-card h4 {
        font-size: 0.95em;
    }

    .featured-article-card p {
        font-size: 0.8em;
        margin-bottom: var(--spacing-sm);
    }

    .featured-article-card .btn-tertiary {
        font-size: 0.8em;
    }

}

@media(max-width:576px) {
    .wiki-top-bar-logo img {
        height: 25px; /* Even smaller logo */
    }
     .wiki-top-bar-content { flex-direction: row; justify-content: space-between; gap: var(--spacing-sm);} /* Layout top bar horizantal on small */
     .wiki-top-bar-nav ul { gap: var(--spacing-sm); justify-content: flex-end;} /* Align nav to the right */
     .wiki-top-bar-nav li { margin-left: auto;}
     .wiki-top-bar-nav .btn { font-size: 0.7em; padding: 4px 6px; } /* Smallest button */


    .wiki-layout-container {
        padding: var(--spacing-lg) var(--spacing-sm);
        gap: var(--spacing-md);
        flex-direction: column;
    }

    .wiki-sidebar {
        padding: var(--spacing-md) var(--spacing-sm);
    }

    .wiki-sidebar-search {
        margin-bottom: var(--spacing-md);
        padding-bottom: var(--spacing-md);
    }

    .wiki-nav-list {
        flex-direction: column;
        align-items: stretch;
        gap: 0;
    }

    .wiki-nav-list li {
        margin-bottom: 0;
        line-height: 1.4;
    }

    .wiki-nav-list li a {
        padding: 1px 0;
        display: block;
        font-size: 0.9em;
    }

    .wiki-nav-list .nav-heading {
        text-align: left;
        margin-top: var(--spacing-md);
        margin-bottom: var(--spacing-sm);
        padding-bottom: var(--spacing-xs);
        font-size: 0.8em;
    }


    .wiki-content {
        padding: var(--spacing-md) 0; /* Adjust vertical padding */
    }

    .wiki-content-header {
        gap: var(--spacing-sm);
        padding-bottom: var(--spacing-sm);
        margin-bottom: var(--spacing-md);
        align-items: flex-start;
         flex-direction: column; /* Stack title and flags */
    }
     .wiki-content-header.main-page-header { flex-direction: column; align-items: center;} /* Ensure centering on main page small */


    .wiki-page-title {
        font-size: 1.6em;
         width: 100%; /* Take full width */
         text-align: center; /* Center title */
    }

    .wiki-main-page-title {
        font-size: 1.8em;
        text-align: center;
        width: 100%;
         margin-top: var(--spacing-sm);
    }

    .wiki-language-flags {
        justify-content: center; /* Center flags */
        width: 100%; /* Take full width */
        gap: var(--spacing-sm);
    }

    .wiki-language-flags img {
        height: 16px;
    }

    .wiki-intro {
        font-size: 0.9em;
        padding: var(--spacing-sm);
        margin: var(--spacing-md) 0;
    }

    .wiki-panel {
        padding: var(--spacing-sm);
        margin-bottom: var(--spacing-md);
    }

    .wiki-toc-title {
        font-size: 0.9em;
        margin-bottom: var(--spacing-sm);
        padding: var(--spacing-xs) var(--spacing-sm); /* Smaller padding for toc title bar */
         margin: calc(var(--spacing-sm) * -1) calc(var(--spacing-sm) * -1) var(--spacing-sm) calc(var(--spacing-sm) * -1); /* Adjust negative margin */
    }

    .wiki-toc-list li a,
    .wiki-toc-list ul li a {
        font-size: 0.85em;
    }

    .wiki-toc-list ul {
        padding-left: var(--spacing-lg);
    }


    .main-index-title-bar {
        font-size: 1em;
        padding: var(--spacing-sm);
         margin-bottom: var(--spacing-md);
    }

     .main-wiki-index .index-categories {
          padding: 0 var(--spacing-sm) var(--spacing-sm) var(--spacing-sm); /* Adjust padding */
     }

     .index-category {
         flex-direction: column; /* Stack elements vertically */
         align-items: flex-start; /* Align to left */
         gap: var(--spacing-xs);
         margin-bottom: var(--spacing-md); /* Space below category block */
          padding-bottom: var(--spacing-md);
     }
      .index-category .category-icon { width: 25px; height: 25px; }

       .index-category .category-info {
           flex-direction: column; /* Title and links are stacked again */
            gap: var(--spacing-xs); /* Space between title and links block */
            width: 100%; /* Info takes full width */
       }
      .index-category .category-title { font-size: 0.9em; margin: 0;}
      .index-category .category-links { font-size: 0.8em; line-height: 1.4; width: 100%; text-align: left;} /* Links text left aligned */

     .category-separator { margin-top: var(--spacing-md); /* Adjust separator spacing */ }


    .wiki-section-title {
        font-size: 1.1em;
        margin-bottom: var(--spacing-md);
        padding-bottom: var(--spacing-xs);
    }

    .wiki-subsection-title {
        font-size: 0.95em;
        margin-bottom: var(--spacing-sm);
    }

    .wiki-content p,
    .wiki-section p,
    .wiki-content ul li,
    .wiki-section ul li {
        font-size: 0.85em;
        line-height: 1.5;
        margin-bottom: var(--spacing-xs);
    }

    .wiki-section ul li,
    .wiki-content ul li {
        padding-left: var(--spacing-md);
    }
    .wiki-content ul li::before, .wiki-section ul li::before { /* Adjust bullet position */ }
     .wiki-section ul li.icon-bullet i.fas { font-size: 1em; }

    .wiki-section ul,
    .wiki-content ul {
        margin: var(--spacing-sm) 0;
    }


    .featured-articles-grid {
        grid-template-columns: 1fr;
        gap: var(--spacing-md);
    }

    .featured-article-card img {
        height: 100px; /* Smaller image */
        margin-bottom: var(--spacing-sm);
    }

    .featured-article-card h4 {
        font-size: 1em;
    }

    .featured-article-card p {
        font-size: 0.8em;
    }

    .featured-article-card .btn-tertiary {
        font-size: 0.8em;
    }


}